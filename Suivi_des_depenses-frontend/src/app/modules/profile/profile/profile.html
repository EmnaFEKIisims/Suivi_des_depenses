<div class="profile-container">
    <!-- Loading State -->
    <div *ngIf="loading" class="loading-section">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
        </div>
        <p>Loading profile information...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-section">
        <div class="error-icon">
            <i class="fas fa-exclamation-triangle"></i>
        </div>
        <h3>Unable to Load Profile</h3>
        <p>{{ error }}</p>
        <button class="btn-retry" (click)="ngOnInit()">
            <i class="fas fa-redo"></i>
            Try Again
        </button>
    </div>

    <!-- Profile Content -->
    <div *ngIf="employee && !loading" class="profile-content">
        <!-- Profile Header -->
        <div class="profile-header">
            <div class="header-content">
                <div class="avatar-section">
                    <div class="avatar avatar-gradient">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="avatar-badge" [class.admin]="isAdmin()">
                        <i class="fas fa-crown"></i>
                    </div>
                </div>
                <div class="header-info">
                    <h1 class="employee-name employee-name-gradient">{{ employee.fullName }}</h1>
                    <p class="employee-occupation">{{ employee.occupation }}</p>
                    <div class="employee-status">
                        <span class="status-badge" [class.active]="employee.status === 'Actif'" 
                              [class.inactive]="employee.status === 'Inactif'">
                            {{ statusMap[employee.status] }}
                        </span>
                        <span class="department-badge">
                            {{ departmentMap[employee.department] }}
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Sections Grid -->
        <div class="profile-grid">
            <!-- Personal Information -->
            <div class="profile-card card-personal">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-id-card"></i>
                    </div>
                    <h3>Personal Information</h3>
                </div>
                <div class="card-content">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-id-card"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ employee.cin || '—' }}</span>
                                <span class="stat-label">CIN</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-hashtag"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ employee.reference || '—' }}</span>
                                <span class="stat-label">Reference</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-birthday-cake"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ formatDate(employee.birthDate) }}</span>
                                <span class="stat-label">Birth Date</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-venus-mars"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ genderMap[employee.gender] || '—' }}</span>
                                <span class="stat-label">Gender</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ employee.phoneNumber || '—' }}</span>
                                <span class="stat-label">Phone</span>
                            </div>
                        </div>
                        <div class="stat-item stat-item-full">
                            <div class="stat-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ employee.address || '—' }}</span>
                                <span class="stat-label">Address</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Professional Information -->
            <div class="profile-card card-professional">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <h3>Professional Information</h3>
                </div>
                <div class="card-content">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ departmentMap[employee.department] || '—' }}</span>
                                <span class="stat-label">Department</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-briefcase"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ employee.occupation || '—' }}</span>
                                <span class="stat-label">Occupation</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-plus"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ formatDate(employee.hireDate) }}</span>
                                <span class="stat-label">Hire Date</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ calculateTenure() }}</span>
                                <span class="stat-label">Tenure Period</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-minus"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ formatDate(employee.exitDate) }}</span>
                                <span class="stat-label">Exit Date</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-info-circle"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value status-display" [class.active]="employee.status === 'Actif'" 
                                      [class.inactive]="employee.status === 'Inactif'">
                                    {{ statusMap[employee.status] }}
                                </span>
                                <span class="stat-label">Status</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Account Information -->
            <div class="profile-card card-account">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-user-shield"></i>
                    </div>
                    <h3>Account Information</h3>
                </div>
                <div class="card-content">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ employee.email || '—' }}</span>
                                <span class="stat-label">Email</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">{{ employee.username || '—' }}</span>
                                <span class="stat-label">Username</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-key"></i>
                            </div>
                            <div class="stat-info">
                                <div class="password-display">
                                    <span class="stat-value">••••••••••••</span>
                                    <span class="password-note">(Encrypted)</span>
                                </div>
                                <span class="stat-label">Password</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-user-tag"></i>
                            </div>
                            <div class="stat-info">
                                <div class="roles-display">
                                    <span *ngFor="let role of getDisplayRoles()" 
                                          class="role-badge-stat" [class.admin]="role === 'Administrator'">
                                        {{ role }}
                                    </span>
                                </div>
                                <span class="stat-label">Roles</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value mfa-status" [class.enabled]="employee.mfaEnabled">
                                    <i class="fas" [class.fa-check-circle]="employee.mfaEnabled" 
                                       [class.fa-times-circle]="!employee.mfaEnabled"></i>
                                    {{ employee.mfaEnabled ? 'Enabled' : 'Disabled' }}
                                </span>
                                <span class="stat-label">MFA Status</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
