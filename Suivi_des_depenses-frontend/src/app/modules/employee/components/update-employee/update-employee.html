<div class="form-container">
  <!-- Alerts Section - Top Center Position -->
  <div class="alert-container">
    <div *ngIf="showSuccessAlert" class="sweet-alert-placeholder" #successAlert></div>
    <div *ngIf="showErrorAlert" class="sweet-alert-placeholder" #errorAlert></div>
  </div>

  <!-- Main Card Container -->
  <div class="main-card">
    <!-- Form Header -->
    <div class="form-header">
      <h1>Update Employee</h1>
      <p class="form-subtitle">Please update the details below</p>
    </div>

    <!-- Navigation Buttons -->
    <div class="d-flex justify-content-between mb-4">
      <button class="btn btn-outline-secondary" (click)="navigateTo('/employees')">
        <i class="bi bi-arrow-left"></i> 
      </button>
      <button class="btn btn-outline-primary" (click)="navigateTo('/home')">
        <i class="bi bi-house-fill"></i> 
      </button>
    </div>

    <!-- Form Wrapper -->
    <div class="form-wrapper">
      <div class="form-card">
        <div class="form-card-header">
          <h2><i class="bi bi-person-fill-gear"></i> Employee Details</h2>
        </div>
        <div class="form-card-body">
          <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()" class="needs-validation" novalidate>
            <div class="form-section">
              <div class="form-grid grid-2">
                <!-- Row 1: Reference + Full Name -->
                <div class="form-group">
                  <label for="reference" class="form-label">Reference <span class="required">*</span></label>
                  <input type="text" class="form-control" id="reference" formControlName="reference" readonly>
                  <div class="form-text text-danger" *ngIf="employeeForm.get('reference')?.invalid && employeeForm.get('reference')?.touched">Reference is required!</div>
                </div>
                <div class="form-group">
                  <label for="fullName" class="form-label">Full Name <span class="required">*</span></label>
                  <input type="text" class="form-control" id="fullName" formControlName="fullName" readonly>
                  <div class="form-text text-danger" *ngIf="employeeForm.get('fullName')?.invalid && employeeForm.get('fullName')?.touched">Full name is required!</div>
                </div>
                <!-- Row 2: CIN + Hire Date -->
                <div class="form-group">
                  <label for="cin" class="form-label">CIN <span class="required">*</span></label>
                  <input type="text" class="form-control" id="cin" formControlName="cin" readonly>
                  <div class="form-text text-danger" *ngIf="employeeForm.get('cin')?.invalid && employeeForm.get('cin')?.touched">CIN is required!</div>
                </div>
                <div class="form-group">
                  <label for="hireDate" class="form-label">Hire Date <span class="required">*</span></label>
                  <input type="date" class="form-control" id="hireDate" formControlName="hireDate" readonly>
                  <div class="form-text text-danger" *ngIf="employeeForm.get('hireDate')?.invalid && employeeForm.get('hireDate')?.touched">Hire date is required!</div>
                </div>
                <!-- Row 3: Status + Exit Date -->
                <div class="form-group">
                  <label for="status" class="form-label">Status <span class="required">*</span></label>
                  <select class="form-select" id="status" formControlName="status" (change)="onStatusChange()"
                    [ngClass]="{'ng-invalid ng-touched': employeeForm.get('status')?.invalid && employeeForm.get('status')?.touched && employeeForm.get('status')?.value === ''}">
                    <option value="">Select Status</option>
                    <option *ngFor="let status of statuses" [value]="status">{{ status }}</option>
                  </select>
                  <div class="form-text text-danger" *ngIf="employeeForm.get('status')?.invalid && employeeForm.get('status')?.touched">Status is required!</div>
                </div>
                <div class="form-group" *ngIf="employeeForm.get('status')?.value === 'Inactif'; else emptyExitDate">
                  <label for="exitDate" class="form-label">Exit Date <span class="required">*</span></label>
                  <input type="date" class="form-control" id="exitDate" formControlName="exitDate"
                    [ngClass]="{'ng-invalid ng-touched': employeeForm.get('exitDate')?.invalid && employeeForm.get('exitDate')?.touched && employeeForm.get('exitDate')?.value === ''}">
                  <div class="form-text text-danger" *ngIf="employeeForm.get('exitDate')?.invalid && employeeForm.get('exitDate')?.touched">Exit date is required!</div>
                </div>
                <ng-template #emptyExitDate>
                  <div class="form-group" style="height: 72px;"></div>
                </ng-template>
                <!-- Row 4: Department + Occupation -->
                <div class="form-group">
                  <label for="department" class="form-label">Department <span class="required">*</span></label>
                  <select class="form-select" id="department" formControlName="department"
                    [ngClass]="{'ng-invalid ng-touched': employeeForm.get('department')?.invalid && employeeForm.get('department')?.touched && employeeForm.get('department')?.value === ''}">
                    <option value="">Select Department</option>
                    <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
                  </select>
                  <div class="form-text text-danger" *ngIf="employeeForm.get('department')?.invalid && employeeForm.get('department')?.touched">Department is required!</div>
                </div>
                <div class="form-group">
                  <label for="occupation" class="form-label">Occupation <span class="required">*</span></label>
                  <select class="form-select" id="occupation" formControlName="occupation" [disabled]="!employeeForm.get('department')?.value"
                    [ngClass]="{'ng-invalid ng-touched': employeeForm.get('occupation')?.invalid && employeeForm.get('occupation')?.touched && employeeForm.get('occupation')?.value === ''}">
                    <option value="">Select Occupation</option>
                    <option *ngFor="let occupation of occupations" [value]="occupation">{{ occupation }}</option>
                  </select>
                  <div class="form-text text-danger" *ngIf="employeeForm.get('occupation')?.invalid && employeeForm.get('occupation')?.touched">Occupation is required!</div>
                </div>
                <!-- Row 5: Email + Phone Number -->
                <div class="form-group">
                  <label for="email" class="form-label">Email <span class="required">*</span></label>
                  <input type="email" class="form-control" id="email" formControlName="email"
                    [ngClass]="{'ng-invalid ng-touched': employeeForm.get('email')?.invalid && employeeForm.get('email')?.touched && employeeForm.get('email')?.value === ''}">
                  <div class="form-text text-danger" *ngIf="employeeForm.get('email')?.invalid && employeeForm.get('email')?.touched">Valid email is required!</div>
                </div>
                <div class="form-group">
                  <label for="phoneNumber" class="form-label">Phone Number <span class="required">*</span></label>
                  <input type="tel" class="form-control" id="phoneNumber" formControlName="phoneNumber"
                    [ngClass]="{'ng-invalid ng-touched': employeeForm.get('phoneNumber')?.invalid && employeeForm.get('phoneNumber')?.touched && employeeForm.get('phoneNumber')?.value === ''}">
                  <div class="form-text text-danger" *ngIf="employeeForm.get('phoneNumber')?.invalid && employeeForm.get('phoneNumber')?.touched">Phone number is required!</div>
                </div>
                <!-- Row 6: Gender + Birth Date -->
                <div class="form-group">
                  <label for="gender" class="form-label">Gender <span class="required">*</span></label>
                  <select class="form-select" id="gender" formControlName="gender"
                    [ngClass]="{'ng-invalid ng-touched': employeeForm.get('gender')?.invalid && employeeForm.get('gender')?.touched && employeeForm.get('gender')?.value === ''}">
                    <option value="">Select Gender</option>
                    <option *ngFor="let gender of genders" [value]="gender">{{ gender }}</option>
                  </select>
                  <div class="form-text text-danger" *ngIf="employeeForm.get('gender')?.invalid && employeeForm.get('gender')?.touched">Gender is required!</div>
                </div>
                <div class="form-group">
                  <label for="birthDate" class="form-label">Birth Date <span class="required">*</span></label>
                  <input type="date" class="form-control" id="birthDate" formControlName="birthDate"
                    [ngClass]="{'ng-invalid ng-touched': employeeForm.get('birthDate')?.invalid && employeeForm.get('birthDate')?.touched && employeeForm.get('birthDate')?.value === ''}">
                  <div class="form-text text-danger" *ngIf="employeeForm.get('birthDate')?.invalid && employeeForm.get('birthDate')?.touched">Birth date is required!</div>
                </div>
                <!-- Row 7: Address (full width) -->
                <div class="form-group full-width">
                  <label for="address" class="form-label">Address <span class="required">*</span></label>
                  <input type="text" class="form-control" id="address" formControlName="address"
                    [ngClass]="{'ng-invalid ng-touched': employeeForm.get('address')?.invalid && employeeForm.get('address')?.touched && employeeForm.get('address')?.value === ''}">
                  <div class="form-text text-danger" *ngIf="employeeForm.get('address')?.invalid && employeeForm.get('address')?.touched">Address is required!</div>
                </div>
                <!-- Row 8: Username + Password -->
                <div class="form-group">
                  <label for="username" class="form-label">Username <span class="required">*</span></label>
                  <input type="text" class="form-control" id="username" formControlName="username"
                    [ngClass]="{'ng-invalid ng-touched': employeeForm.get('username')?.invalid && employeeForm.get('username')?.touched && employeeForm.get('username')?.value === ''}">
                  <div class="form-text text-danger" *ngIf="employeeForm.get('username')?.invalid && employeeForm.get('username')?.touched">Username is required!</div>
                </div>
                <div class="form-group">
                  <label for="password" class="form-label">Password <span class="required">*</span></label>
                  <div class="input-group">
                    <input [type]="showPassword ? 'text' : 'password'" class="form-control" id="password" formControlName="password"
                      [ngClass]="{'ng-invalid ng-touched': employeeForm.get('password')?.invalid && employeeForm.get('password')?.touched && employeeForm.get('password')?.value === ''}">
                    <button class="btn btn-outline-secondary" type="button" (click)="togglePasswordVisibility()">
                      <i class="bi" [ngClass]="{'bi-eye': !showPassword, 'bi-eye-slash': showPassword}"></i>
                    </button>
                  </div>
                  <div class="form-text text-danger" *ngIf="employeeForm.get('password')?.invalid && employeeForm.get('password')?.touched">Password is required!</div>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="form-card-footer">
          <div class="form-actions">
            <div class="secondary-actions">
              <button type="button" class="btn btn-cancel" (click)="navigateTo('/employees')">Cancel</button>
            </div>
            <div class="primary-actions">
              <button type="submit" class="btn btn-submit" [disabled]="employeeForm.invalid" (click)="onSubmit()">Update Employee</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>